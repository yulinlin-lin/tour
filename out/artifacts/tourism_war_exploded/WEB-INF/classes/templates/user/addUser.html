<!DOCTYPE html><html lang="en"  xmlns:th="http://www.thymeleaf.org"><head>    <meta charset="utf-8">    <title>考勤列表</title>    <meta name="renderer" content="webkit">    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">    <meta name="apple-mobile-web-app-status-bar-style" content="black">    <meta name="apple-mobile-web-app-capable" content="yes">    <meta name="format-detection" content="telephone=no">    <link rel="stylesheet" href="layui/css/layui.css" th:href="@{/layui/css/layui.css}" />    <link rel="stylesheet" href="css/public.css" th:href="@{/css/public.css}" />    <script type="text/javascript" src="layui/layui.js" th:src="@{/layui/layui.js}"></script></head><body class="childrenBody"><div class="x-body">    <form id="myadd" lay-submit          lay-filter="userForm" class="layui-form" enctype="multipart/form-data">        <div class="layui-form-item">            <label for="U_name" class="layui-form-label">                <span class="x-red">*</span>姓名            </label>            <div class="layui-input-inline">                <input type="text" id="U_name" name="userName" required="" lay-verify="nikename"                       autocomplete="off" class="layui-input">            </div>        </div>        <div class="layui-form-item">            <label for="U_pass" class="layui-form-label">                <span class="x-red">*</span>密码            </label>            <div class="layui-input-inline">                <input type="password" id="U_pass" name="password" required="" lay-verify="pass"                       autocomplete="off" class="layui-input">            </div>            <div class="layui-form-mid layui-word-aux">                6到16个字符            </div>        </div>        <div class="layui-form-item">            <label for="S_phone" class="layui-form-label">                <span class="x-red">*</span>电话            </label>            <div class="layui-input-inline">                <input type="text" id="S_phone" name="phone" required="" lay-verify="phone"                       autocomplete="off" class="layui-input">            </div>            <div class="layui-form-mid layui-word-aux">                <span class="x-red">*</span>请输入电话号码            </div>        </div>        <div class="layui-form-item">            <label class="layui-form-label">性别</label>            <div class="layui-input-block">                <input type="radio" name="sex" value="1" title="男" checked>                <input type="radio" name="sex" value="0" title="女">            </div>        </div>        <div class="layui-form-item">            <label class="layui-form-label">角色</label>            <div class="layui-input-block">                <input type="radio" name="roleType" value="1" title="管理员">                <input type="radio" name="roleType" value="2" title="供应商">                <input type="radio" name="roleType" value="3" title="游客" checked>            </div>        </div>        <div class="layui-form-item">            <label class="layui-form-label">照片</label>            <div class="layui-input-block"><!--                下面这个是： 上传的按钮-->                <button type="button" class="layui-btn" id="upload1">上传图片</button><!--                图片上传成功后，返回来的图url 保存在下面这个隐藏的input里面；-->                <input type="hidden" id="img_url" name="imgFileName" value=""/><!--                图片预览的div-->                <div class="layui-upload-list">                    <img class="layui-upload-img" width="100px" height="80px" id="demo1"/>                    <p id="demoText"></p>                </div>            </div>        </div>        <div class="layui-form-item" style="margin-top:20px;">            <label  class="layui-form-label">            </label>            <button  class="layui-btn" lay-submit="" lay-filter="addUser">                增加            </button>        </div>    </form></div><script type="text/javascript" th:inline="javascript">    layui.use(['layer', 'form', 'upload', 'laydate'], function() {        let layer = layui.layer;        let form = layui.form;        let upload = layui.upload;        let laydate = layui.laydate;        //  先把图片上传到映射的路径中去，会返回来一个图片保存的路径；        upload.render({            elem: '#upload1',            url: '/uploadImg',            before: function(obj){            //预读本地文件示例，不支持ie8            obj.preview(function(index, file, result){                $('#demo1').attr('src', result); //图片链接（base64）            });        },            done: function(res) {                // 如果上传失败                if(res.code > 0) {                    return layer.msg('上传失败');                }                // 上传成功                //上传成功                alert("上传成功"+res.url);                document.getElementById("img_url").value = res.url;            },            error: function() {                // 演示失败状态，并实现重传                var demoText = $('#demoText');                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');                demoText.find('.demo-reload').on('click', function() {                    uploadInst.upload();                });            }        });    });</script><script type="text/javascript" th:inline="javascript">    layui.use(['form','layedit','layer'], function(){        var form = layui.form            , layer = layui.layer            , $ = layui.jquery;        //监听提交        //signAdd为提交按钮的id        form.on('submit(addUser)', function(data){            console.log(data.field);            $.ajax({               type: 'POST',               url: '/userRegister',                dataType: 'json',                data: data.field,                async: true,                success: function (result) {                    if (result.code == 0) {                        layer.msg('保存成功', {icon: 1, time: 1000});                        layer.msg('添加成功',  {icon: 1}, function() {                            var indexx = parent.layer.getFrameIndex(window.name); // 先得到当前iframe层的索引                            parent.layer.close(indexx);                            parent.location.reload();                        });                    } else {                        layer.msg('保存失败！' + result.msg, {icon: 2, time: 1000});                    }                },                error: function (result, type) {                    layer.msg('保存失败！', {icon: 2, time: 1000});                }            });        return false;    });        //自定义验证规则        form.verify({            nikename: function(value){                var res = isNull(value);                if (res == true){                    return "请输入正确的字符串，并且不能全是空格";                }                if(value.length < 1){                    return '昵称至少得1个字符啊';                }            }            ,pass: [/(.+){6,12}$/, '密码必须6到12位']        });    });    //验证用户输入的用户名，是一个正确的字符串；    function isNull( str ){        if ( str == "" ) return true;        var regu = "^[ ]+$";        var re = new RegExp(regu);        return re.test(str);    }</script><script type="text/javascript" src="fjs/editUser.js" th:src="@{/fjs/editUser.js}"></script></body></html>